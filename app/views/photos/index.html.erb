<div class="page-header">
  <h1>Wallpaper</h1>
    <a href="/photos/new" class="btn btn-lg btn-success"><i class="fa fa-plus"></i> New Photo</a>
  
</div>

<% @photos.each do |photo| %>
<div class="col-md-8 col-md-offset-2">
  <div class="panel panel-default">
    <div class="panel-heading">
      <h3 class="panel-title">
        <a href="/users/<%=photo.user_id%>"><%=photo.user.username%></a>
        <small><%= (Time.now - photo.created_at).to_i/(24*60*60) %> day(s) ago</small>
      </h3>
    </div>
    <div class="panel-body">
      <a href="/photos/<%=photo.id%>">
        <img src="<%=photo.image%>" class="img-responsive">
      </a>
      <%if photo.likes.find_by(:user_id => current_user.id) == nil %>
      <form action="/quick_like" method="post">
        <!-- Hidden input for authenticity token to protect from forgery -->
        <input name="authenticity_token" type="hidden" value="0j/IxsLx+B9a8c5/ZvnjLDBu+ALciglDXvr33k8QTrAg445508w3tciSXLfk0iurj7zncUHe9gitxaBLmG133Q==">
        <input type="hidden" name="photo_id" value="<%=photo.id%>">
        <input type="hidden" name="user_id" value="<%=current_user.id%>">
        <button class="btn btn-link"><i class="fa fa-heart-o"></i></button>
      </form>
      <%else%>
      <a href="/delete_like/<%=photo.likes.find_by(:user_id => current_user.id).id%>" class="btn btn-link"><i class="fa fa-heart"></i></a>
      <%end%>
      
      <ul class="media-list">
        <% photo.comments.each do |comment|%>
        <li class="media">
          <div class="media-body">
            <h6 class="media-heading">
              <a href="/users/<%= comment.user.id %>"><%= comment.user.username %></a>
              <small><%= (Time.now - comment.updated_at).to_i/(24*60*60) %> day(s) ago</small>
            </h6>
            <%=comment.body%>
            </div>
          </li>
        <%end%>
        <li class="media">
          <div class="media-body">
            <form action="/quick_comment" method="post">
              <!-- Hidden input for authenticity token to protect from forgery -->
              <input name="authenticity_token" type="hidden" value="0j/IxsLx+B9a8c5/ZvnjLDBu+ALciglDXvr33k8QTrAg445508w3tciSXLfk0iurj7zncUHe9gitxaBLmG133Q==">
              <input type="hidden" name="photo_id" value="<%=photo.id%>">
              <input type="hidden" name="user_id" value="<%=current_user.id%>">

              <!-- Label and input for body -->
              <div class="form-group">
                <label for="body" class="sr-only">Body</label>

                <div class="input-group">
                  <input type="text" id="body" name="body" class="form-control" placeholder="Add a comment..." required="">

                  <span class="input-group-btn">
                    <button class="btn btn-default" type="submit"><i class="fa fa-commenting-o"></i></button>
                  </span>
                </div>
              </div>
            </form>
          </div>
        </li>
      </ul>
      
      <div class="btn-group btn-group-justified">
        <a href="/photos/<%= photo.id %>" class="btn btn-primary">Show</a>
        <% if photo.user == current_user %>
        <a href="/photos/<%= photo.id %>/edit" class="btn btn-warning">Edit</a>
        <a href="/delete_photo/<%= photo.id %>" class="btn btn-danger" rel="nofollow">Delete</a>
        <% end %>
      </div>
    </div>
  </div>
</div>
<% end %>


